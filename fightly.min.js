!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("fightly",[],t):"object"==typeof exports?exports.fightly=t():e.fightly=t()}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e){console.log("make app");var t=new u["default"],n=new y["default"](t),o=new h["default"](t,n,e),r=new s["default"],i=(0,l["default"])(n);return t.manager=r,t.network=n,t.actions=i,Object.defineProperty(t,"games",{get:function(){return o.games}}),t}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),s=o(i),a=n(2),u=o(a),c=n(3),l=o(c),f=n(4),h=o(f),p=n(5),y=o(p);t["default"]=r},function(e,t,n){!function(t,n){e.exports=n()}(this,function(){"use strict";function e(t){if(null==t||"object"!=("undefined"==typeof t?"undefined":n(t)))return t;var o;if(t instanceof Date)return o=new Date,o.setTime(t.getTime()),o;if(t instanceof Array){o=[];for(var r=0,i=t.length;r<i;r++)o[r]=e(t[r]);return o}if(t instanceof Object){o={};for(var s in t)t.hasOwnProperty(s)&&(o[s]=e(t[s]));return o}}function t(e){return e&&"[object Function]"==={}.toString.call(e)}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=(function(){function e(e){this.value=e}function t(e){function t(e,t){return new Promise(function(o,s){var a={key:e,arg:t,resolve:o,reject:s,next:null};i?i=i.next=a:(r=i=a,n(e,t))})}function n(t,r){try{var i=e[t](r),s=i.value;s instanceof a?Promise.resolve(s.value).then(function(e){n("next",e)},function(e){n("throw",e)}):o(i.done?"return":"normal",i.value)}catch(a){o("throw",a)}}function o(e,t){switch(e){case"return":r.resolve({value:t,done:!0});break;case"throw":r.reject(t);break;default:r.resolve({value:t,done:!1})}r=r.next,r?n(r.key,r.arg):i=null}var r,i;this._invoke=t,"function"!=typeof e["return"]&&(this["return"]=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype["throw"]=function(e){return this._invoke("throw",e)},t.prototype["return"]=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=function(){function n(e){o(this,n),this.listener=null,e&&t(e.emit)&&(this.listener=e),this.entities=[],this.components={},this.assemblages={},this.entityComponentData={},this.processors=[],this.uid=0}return r(n,[{key:"getUid",value:function(){return this.uid++}},{key:"createEntity",value:function(e){var t=this.getUid();return this.addComponentsToEntity(e,t),this.entities.push(t),t}},{key:"removeEntity",value:function(e){for(var t in this.entityComponentData)this.entityComponentData.hasOwnProperty(t)&&this.entityComponentData[t][e]&&delete this.entityComponentData[t][e];return this.entities.splice(this.entities.indexOf(e),1),this}},{key:"addComponent",value:function(e,t){return this.components[e]=t,this}},{key:"removeComponent",value:function(e){return delete this.components[e],delete this.entityComponentData[e],this}},{key:"getComponentsList",value:function(){return Object.keys(this.components)}},{key:"addComponentsToEntity",value:function(t,n){var o,r,i=this;for(o=t.length-1;o>=0;o--)if(r=t[o],!this.components[r])throw new Error("Trying to use unknown component: "+r);for(o=t.length-1;o>=0;o--){r=t[o],this.entityComponentData[r]||(this.entityComponentData[r]={});var s=null;i.listener?(s={},function(t){var o=e(i.components[r].state);for(var s in o)o.hasOwnProperty(s)&&!function(e){Object.defineProperty(t,e,{get:function(){return o[e]},set:function(t){o[e]=t,i.listener.emit("entityComponentUpdated",n,r)}})}(s)}(s)):s=e(i.components[r].state),s.__id=n,this.entityComponentData[r][n]=s}return this}},{key:"removeComponentsFromEntity",value:function(e,t){var n,o;for(n=e.length-1;n>=0;n--)if(o=e[n],!this.components[o])throw new Error("Trying to use unknown component: "+o);for(n=e.length-1;n>=0;n--)o=e[n],this.entityComponentData[o]&&this.entityComponentData[o][t]&&delete this.entityComponentData[o][t];return this}},{key:"getComponentDataForEntity",value:function(e,t){if(!(e in this.components))throw new Error("Trying to use unknown component: "+e);if(!this.entityComponentData.hasOwnProperty(e)||!this.entityComponentData[e].hasOwnProperty(t))throw new Error("No data for component "+e+" and entity "+t);return this.entityComponentData[e][t]}},{key:"updateComponentDataForEntity",value:function(e,t,n){var o=this.getComponentDataForEntity(e,t);for(var r in n)n.hasOwnProperty(r)&&o.hasOwnProperty(r)&&(o[r]=n[r]);return this}},{key:"getComponentsData",value:function(e){if(!(e in this.components))throw new Error("Trying to use unknown component: "+e);return this.entityComponentData.hasOwnProperty(e)?this.entityComponentData[e]:[]}},{key:"entityHasComponent",value:function(e,t){return t in this.components&&this.entityComponentData.hasOwnProperty(t)&&this.entityComponentData[t].hasOwnProperty(e)}},{key:"addAssemblage",value:function(e,t){return this.assemblages[e]=t,this}},{key:"removeAssemblage",value:function(e){return delete this.assemblages[e],this}},{key:"createEntityFromAssemblage",value:function(e){if(!(e in this.assemblages))throw new Error("Trying to use unknown assemblage: "+e);var t=this.assemblages[e],n=this.createEntity(t.components);for(var o in t.initialState)if(t.initialState.hasOwnProperty(o)){var r=t.initialState[o];this.updateComponentDataForEntity(o,n,r)}return n}},{key:"addProcessor",value:function(e){return this.processors.push(e),this}},{key:"removeProcessor",value:function(e){return this.processors.splice(this.processors.indexOf(e),1),this}},{key:"update",value:function(e){for(var t=0;t<this.processors.length;t++)this.processors[t].update(e);return this}}]),n}();return i})},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function r(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!r(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,r,a,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(n=this._events[e],s(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(i(n))for(a=Array.prototype.slice.call(arguments,1),c=n.slice(),r=c.length,u=0;u<r;u++)c[u].apply(this,a);return!0},n.prototype.addListener=function(e,t){var r;if(!o(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(r=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,r,s,a;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,r=-1,n===t||o(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(a=s;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],o(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){"use strict";function n(e){function t(t){e.emit("action",t)}return{createGame:function(){t({type:"createGame"})},joinGame:function(e){t({type:"joinGame",game:e})}}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(2),l=o(c),f=function(e){function t(e,n,o){i(this,t);var r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.msg="ICH BIN EIN BERLINER",r.emitter=e,r.network=n,r._available_modules=o,r._modules=[],r._components=[],r._processors=[],r._actions=[],r.games=[],r._setEventListeners(),r}return a(t,e),u(t,[{key:"_setEventListeners",value:function(){var e=this;this.emitter.on("connection",function(){e.network.emit("request",{type:"modules"}),e.network.emit("request",{type:"games"}),e.emitter.emit("ready")}),this.emitter.on("data",function(t){switch(console.log("received data"),console.log(t),console.log(e.msg),t.type){case"modules":console.log("Modules list received"),e.loadModules(t.data);break;case"games":console.log("Games list received"),e.games=t.data}}),this.emitter.on("gameJoined",function(e){console.log("Game joined!")})}},{key:"loadModules",value:function(e){var t=this;console.log("Loading modules..."),console.log(e),e.forEach(function(n){var o,i,s,a=e[n];t._modules.push(n),console.log(a),(o=t._actions).push.apply(o,r(a.actions)),(i=t._components).push.apply(i,r(a.components)),(s=t._processors).push.apply(s,r(a.processors))})}}]),t}(l["default"]);t["default"]=f},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(t){n(this,e),this.listener=t;var o=io();o.on("connect_failed",function(){console.log("ERROR - Connection to the server failed")}),o.on("connect",this.onConnect.bind(this)),o.on("disconnect",this.onDisconnect.bind(this)),o.on("data",this.onData.bind(this)),o.on("gameJoined",this.onGameJoined.bind(this)),this._socket=o}return o(e,[{key:"emit",value:function(e,t){t=JSON.stringify(t),this._socket.emit(e,t)}},{key:"onConnect",value:function(){console.log("Connected to the server"),this.listener.emit("connection")}},{key:"onData",value:function(e){console.log("Received data"),this.listener.emit("data",JSON.parse(e))}},{key:"onGameJoined",value:function(e){console.log("Received gameJoined"),this.listener.emit("gameJoined",JSON.parse(e))}},{key:"onDisconnect",value:function(){console.log("Disconnected from the server"),this.listener.emit("disconnection")}}]),e}();t["default"]=r}])});
//# sourceMappingURL=fightly.min.js.map